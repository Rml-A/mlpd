{% extends 'base.html' %}

{% block title %}Список задач{% endblock %}

{% block content %}
    <h2>Список задач</h2>
    <a href="{{ url_for('create_task') }}">Создать новую задачу</a>

    <form action="{{ url_for('tasks') }}" method="get">
        <label for="status">Фильтр по статусу:</label>
        <select id="status" name="status">
            <option value="">Все</option>
            <option value="Новая">Новая</option>
            <option value="В работе">В работе</option>
            <option value="Завершена">Завершена</option>
            <option value="Отложена">Отложена</option>
            <option value="Отменена">Отменена</option>
        </select>
        <button type="submit">Применить фильтр</button>
    </form>

    {% for task in tasks %}
        <div class="task">
            <h3>{{ task.title }}</h3>
            <p>{{ task.description }}</p>
            <p>Статус: {{ task.status }}</p>
            <form method="POST" action="{{ url_for('update_task_status', task_id=task.id) }}">
                <select name="new_status">
                    <option value="Новая">Новая</option>
                    <option value="В работе">В работе</option>
                    <option value="Завершена">Завершена</option>
                    <option value="Отложена">Отложена</option>
                    <option value="Отменена">Отменена</option>
                </select>
                <button type="submit">Изменить статус</button>
            </form>
            <a href="{{ url_for('edit_task', id=task.id) }}">Редактировать</a>
            <a href="{{ url_for('delete_task', id=task.id) }}" onclick="return confirm('Вы уверены, что хотите удалить эту задачу?')">Удалить</a>
        </div>
    {% endfor %}
{% endblock %}
